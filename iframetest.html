<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GivingData – Interaction Panel (Test)</title>
<style>
    * {
        box-sizing: border-box;
    }
    body {
        font-family: "Segoe UI", Arial, sans-serif;
        margin: 0;
        padding: 16px 18px;
        background: #ffffff;
        color: #222;
        font-size: 13px;
    }

    .header {
        display: flex;
        align-items: center;
        margin-bottom: 16px;
    }
    .logo-circle {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 1px solid #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        font-weight: 600;
        color: #0b62a4;
        margin-right: 8px;
    }
    .header-title {
        font-size: 18px;
        font-weight: 400;
    }

    .subtext {
        margin-bottom: 12px;
        color: #666;
    }

    .field-label {
        font-size: 11px;
        text-transform: uppercase;
        color: #888;
        margin-top: 10px;
        margin-bottom: 2px;
        letter-spacing: 0.03em;
    }

    .field-value {
        font-size: 13px;
        margin-bottom: 4px;
        color: #222;
    }

    .field-value-muted {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
    }

    .section-divider {
        margin-top: 8px;
        margin-bottom: 4px;
    }

    /* Organization boxed area (주황색 테두리) */
    .org-box-wrapper {
        margin-top: 4px;
        margin-bottom: 4px;
    }
    .org-box {
        border: 2px solid #f79a3c;
        border-radius: 4px;
        padding: 6px 8px;
    }
    .org-box select {
        width: 100%;
        border: none;
        outline: none;
        background: transparent;
        font-size: 13px;
    }

    select.request-select {
        width: 100%;
        padding: 6px 8px;
        font-size: 13px;
        border-radius: 2px;
        border: 1px solid #ccc;
        background: #fff;
    }

    /* Notes area + 툴바 (간단하게 모양만) */
    .notes-toolbar {
        display: flex;
        align-items: center;
        border: 1px solid #d0d0d0;
        border-bottom: none;
        border-radius: 2px 2px 0 0;
        background: #f9f9f9;
        padding: 2px 4px;
        gap: 2px;
    }
    .toolbar-button {
        border: none;
        background: transparent;
        padding: 2px 4px;
        font-size: 12px;
        cursor: pointer;
        color: #555;
    }
    .toolbar-separator {
        width: 1px;
        height: 16px;
        background: #ddd;
        margin: 0 3px;
    }
    .notes-area {
        border: 1px solid #d0d0d0;
        border-radius: 0 0 2px 2px;
    }
    .notes-area textarea {
        width: 100%;
        height: 120px;
        border: none;
        outline: none;
        resize: vertical;
        padding: 6px 8px;
        font-size: 13px;
        font-family: "Segoe UI", Arial, sans-serif;
    }
</style>
</head>
<body>

<div class="header">
    <div class="logo-circle">SS</div>
    <div class="header-title">Test</div>
</div>

<div class="subtext" id="introText">
    Create a new Interaction record for GivingData from this email.
</div>

<div class="field-label">Interaction Title</div>
<div class="field-value" id="interactionTitle">Loading subject…</div>

<div class="field-label">Messages</div>
<div class="field-value" id="messageCount">1 Message</div>

<div class="field-label">Contacts</div>
<div class="field-value" id="contactName">Loading contact…</div>
<div class="field-value-muted" id="contactEmail"></div>

<div class="field-label">Staff</div>
<div class="field-value" id="staffName">Grant Manager</div>

<div class="field-label">Organization</div>
<div class="org-box-wrapper">
    <div class="org-box">
        <select id="organizationSelect">
            <!-- 정적 데이터 3개 -->
            <option value="grantseeking-org">Grantseeking Organization</option>
            <option value="new-hope-foundation">New Hope Foundation</option>
            <option value="community-support">Community Support Alliance</option>
        </select>
    </div>
</div>

<div class="field-label">Request</div>
<select class="request-select" id="requestSelect">
    <option value="">Select Request</option>
    <option value="letter-of-inquiry">Letter of Inquiry</option>
    <option value="full-proposal">Full Proposal</option>
    <option value="site-visit">Site Visit Follow-up</option>
</select>

<div class="field-label">Interaction Notes</div>
<div class="notes-toolbar">
    <button class="toolbar-button"><b>B</b></button>
    <button class="toolbar-button"><i>I</i></button>
    <button class="toolbar-button">&#8226; List</button>
    <button class="toolbar-button">&#35; List</button>
    <div class="toolbar-separator"></div>
    <button class="toolbar-button">“Quote”</button>
    <div class="toolbar-separator"></div>
    <button class="toolbar-button">⟲</button>
    <button class="toolbar-button">⟳</button>
</div>
<div class="notes-area">
    <textarea id="notesTextarea" placeholder="Enter notes…"></textarea>
</div>

<!-- Office.js (Outlook 에서만 의미 있음) -->
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<script>
(function () {
    // Office.js 없으면(브라우저 단독 테스트) 기본 텍스트만 유지
    if (!window.Office) {
        console.log("Office.js not found – opened outside Outlook. Using fallback values.");
        document.getElementById("interactionTitle").textContent = "Letter of Inquiry (Test)";
        document.getElementById("contactName").textContent = "Sally Grantseeker";
        document.getElementById("contactEmail").textContent = "stacey.dabaldo@givingdata.com";
        document.getElementById("notesTextarea").value =
            "Test mode: Outlook item not available.\nYou can still test layout in the browser.";
        return;
    }

    Office.onReady(function (info) {
        console.log("Office.onReady:", info);

        if (info.host !== Office.HostType.Outlook) {
            console.log("Host is not Outlook:", info.host);
            return;
        }

        var item = Office.context.mailbox.item;
        console.log("Outlook item:", item);

        // Subject → Interaction Title
        var subject = item.subject || "(No subject)";
        document.getElementById("interactionTitle").textContent = subject;

        // From → Contacts
        var fromText = "Unknown sender";
        var emailText = "";
        if (item.from) {
            fromText = item.from.displayName || item.from.emailAddress || "Unknown sender";
            emailText = item.from.emailAddress || "";
        }
        document.getElementById("contactName").textContent = fromText;
        document.getElementById("contactEmail").textContent = emailText;

        // Messages: 단순히 1 Message 또는 ConversationIndex로 바꿀 수도 있음
        document.getElementById("messageCount").textContent = "1 Message";

        // Notes 초기값에 기본 정보 넣기 (원하면 제거 가능)
        var notes = "";
        notes += "Subject: " + subject + "\n";
        if (emailText) {
            notes += "From: " + fromText + " <" + emailText + ">\n";
        } else {
            notes += "From: " + fromText + "\n";
        }

        // To 받는사람들
        if (item.to && item.to.length > 0) {
            notes += "To:\n";
            item.to.forEach(function (rec) {
                notes += "  - " + (rec.displayName || rec.emailAddress) +
                         " <" + (rec.emailAddress || "") + ">\n";
            });
        }

        notes += "\n--- Interaction Notes ---\n";
        document.getElementById("notesTextarea").value = notes;
    });
})();
</script>

</body>
</html>
