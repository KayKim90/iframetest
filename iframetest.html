<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SmartSimple – Interaction (Test)</title>
<style>
    * { box-sizing: border-box; }
    body {
        font-family: "Segoe UI", Arial, sans-serif;
        margin: 0;
        padding: 16px 18px;
        background: #ffffff;
        color: #222;
        font-size: 13px;
    }

    /* Header */
    .header {
        display: flex;
        align-items: center;
        margin-bottom: 16px;
    }
    .logo-circle {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 1px solid #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        font-weight: 600;
        color: #3c8f4a;
        margin-right: 8px;
    }
    .header-title {
        font-size: 18px;
        font-weight: 400;
    }

    .subtext {
        margin-bottom: 12px;
        color: #666;
        line-height: 1.4;
    }

    /* Field Labels / Values */
    .field-label {
        font-size: 11px;
        text-transform: uppercase;
        color: #888;
        margin-top: 10px;
        margin-bottom: 2px;
        letter-spacing: 0.03em;
    }
    .field-value {
        font-size: 13px;
        margin-bottom: 4px;
        color: #222;
    }
    .field-value-muted {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
    }

    /* Organization green box */
    .org-box-wrapper {
        margin-top: 4px;
        margin-bottom: 4px;
    }
    .org-box {
        border: 2px solid #3c8f4a;
        border-radius: 4px;
        padding: 6px 8px;
    }
    .org-box select {
        width: 100%;
        border: none;
        outline: none;
        background: transparent;
        font-size: 13px;
    }

    /* Notes Area */
    .notes-area textarea {
        width: 100%;
        height: 120px;
        border-radius: 3px;
        border: 1px solid #d0d0d0;
        outline: none;
        resize: vertical;
        padding: 6px 8px;
        font-size: 13px;
        font-family: "Segoe UI", Arial, sans-serif;
        margin-top: 4px;
    }

    /* Bottom Button */
    .footer-actions {
        margin-top: 18px;
        display: flex;
        justify-content: flex-end;
    }
    .primary-btn {
        padding: 7px 16px;
        font-size: 13px;
        border-radius: 3px;
        border: none;
        background-color: #3c8f4a;
        color: #fff;
        cursor: pointer;
    }
    .primary-btn:hover {
        background-color: #2f6f3a;
    }
</style>
</head>
<body>

<!-- Header -->
<div class="header">
    <div class="logo-circle">SS</div>
    <div class="header-title">SmartSimple</div>
</div>

<div class="subtext" id="introText">
    Create a new Interaction record for SmartSimple from this email.
</div>

<!-- Interaction Title -->
<div class="field-label">Interaction Title</div>
<div class="field-value" id="interactionTitle">Loading subject…</div>

<!-- Messages -->
<div class="field-label">Messages</div>
<div class="field-value" id="messageCount">1 Message</div>

<!-- Contacts -->
<div class="field-label">Contacts</div>
<div class="field-value" id="contactName">Loading contact…</div>
<div class="field-value-muted" id="contactEmail"></div>

<!-- Organization -->
<div class="field-label">Organization</div>
<div class="org-box-wrapper">
    <div class="org-box">
        <select id="organizationSelect">
            <option value="grantseeking-org">Grantseeking Organization</option>
            <option value="new-hope-foundation">New Hope Foundation</option>
            <option value="community-support">Community Support Alliance</option>
        </select>
    </div>
</div>

<!-- Notes -->
<div class="field-label">Interaction Notes</div>
<div class="notes-area">
    <textarea id="notesTextarea" placeholder="Enter notes…"></textarea>
</div>

<!-- Bottom button -->
<div class="footer-actions">
    <button class="primary-btn" id="createInteractionBtn">Create Interaction</button>
</div>

<!-- Office.js -->
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

<script>
(function () {
    // Outside Outlook fallback
    if (!window.Office) {
        console.log("Office.js not found – using fallback values.");
        document.getElementById("interactionTitle").textContent = "Letter of Inquiry (Test)";
        document.getElementById("contactName").textContent = "Sally Grantseeker";
        document.getElementById("contactEmail").textContent = "stacey.dabaldo@SmartSimple.com";
        return;
    }

    Office.onReady(function (info) {
        if (info.host !== Office.HostType.Outlook) return;

        var item = Office.context.mailbox.item;
        console.log("Office.js item = ",item);
        // Subject → Interaction Title
        document.getElementById("interactionTitle").textContent =
            item.subject || "(No subject)";

        // From → Contact
        if (item.from) {
            document.getElementById("contactName").textContent =
                item.from.displayName || item.from.emailAddress;
            document.getElementById("contactEmail").textContent =
                item.from.emailAddress || "";
        }
    });

    // Test click handler
    document.getElementById("createInteractionBtn").addEventListener("click", function () {
        alert("Create Interaction clicked (test)");
    });
})();
</script>

</body>
</html>
